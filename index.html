<!DOCTYPE html>
<html>
<head>
  <title>Routine Planner</title>
  <style>
    html {
      height: 100%;
      width: 100%;
    }

    body {
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      margin: 0;
      background-color: #f0f0f0;
    }

    h1 {
      margin-bottom: 20px;
      text-align: center;
      color: #333;
    }

    .container {
      display: flex;
      flex-direction: column;
      width: 500px;
      margin: 0 auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background-color: #fff;
    }

    .time-slot {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background-color: #eee;
      position: relative; /* To position the color input and delete button */
    }

    .time-slot input[type="color"] {
      position: absolute;
      top: 5px;
      right: 5px;
    }

    .time-slot.work {
      background-color: #f2f2f2;
    }

    .time-slot.break {
      background-color: #e0e0e0;
    }

    .time {
      font-weight: bold;
    }

    .input-group {
      display: flex;
    }

    .input-group input[type="text"] {
      padding: 5px;
      margin-right: 10px;
      border: 1px solid #ccc;
      border-radius: 3px;
      flex-grow: 1;
    }

    .input-group button {
      padding: 5px 10px;
      border: none;
      border-radius: 3px;
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
    }

    ul {
      list-style: none;
      padding: 0;
      margin-top: 10px;
    }

    li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 5px;
      margin-bottom: 5px;
      border: 1px solid #ccc;
      border-radius: 3px;
      background-color: #fff;
    }

    li span {
      flex-grow: 1;
    }

    li button {
      padding: 5px 10px;
      border: none;
      border-radius: 3px;
      background-color: #f44336;
      color: white;
      cursor: pointer;
      display: none; /* Initially hidden */
    }

    li:hover button {
      display: block; /* Show on hover */
    }

    .add-time-slot {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }

    .add-time-slot button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      background-color: #008CBA;
      color: white;
      cursor: pointer;
    }

    /* Delete buttons initially hidden */
    li button,
    .time-slot button {
      display: none;
    }

    /* Show delete buttons on hover */
    li:hover button,
    .time-slot:hover button {
      display: block;
    }
  </style>
</head>
<body>
  <h1>My Daily Routine</h1>
  <div class="container">
    <div class="time-slot work" id="timeSlot-8am">
      <span class="time" id="time-8am">8:00 AM</span>
      <input type="color" id="color-8am" onchange="changeSlotColor('8am')">
      <div class="input-group">
        <input type="text" id="activity-8am" placeholder="Activity">
        <button onclick="addActivity('8am')">Add</button>
      </div>
      <ul id="activities-8am"></ul>
      <button onclick="deleteTimeSlot('8am')">Delete Time Slot</button>
    </div>
    <div class="add-time-slot">
      <button onclick="addTimeSlot()">Add Time Slot</button>
    </div>
  </div>

  <script>
    let timeSlotCounter = 5; // Keep track of time slot IDs

    function addActivity(time) {
      const activityInput = document.getElementById(`activity-${time}`);
      const activityValue = activityInput.value.trim();

      if (activityValue !== "") {
        const activitiesList = document.getElementById(`activities-${time}`);
        const newActivity = document.createElement("li");
        newActivity.innerHTML = `
          <span>${activityValue}</span>
          <button onclick="deleteActivity(this)">Delete</button>
        `;
        activitiesList.appendChild(newActivity);
        activityInput.value = ""; // Clear the input field
        saveActivities();
      }
    }

    function deleteActivity(button) {
      const activityItem = button.parentElement;
      activityItem.remove();
      saveActivities();
    }

    function addTimeSlot() {
      timeSlotCounter++;
      const newTimeSlot = document.createElement("div");
      newTimeSlot.classList.add("time-slot");
      newTimeSlot.setAttribute("id", `timeSlot-${timeSlotCounter}`);
      newTimeSlot.innerHTML = `
        <span class="time" id="time-${timeSlotCounter}">Time Slot ${timeSlotCounter}</span>
        <input type="color" id="color-${timeSlotCounter}" onchange="changeSlotColor('${timeSlotCounter}')">
        <div class="input-group">
          <input type="text" id="activity-${timeSlotCounter}" placeholder="Activity">
          <button onclick="addActivity('${timeSlotCounter}')">Add</button>
        </div>
        <ul id="activities-${timeSlotCounter}"></ul>
        <button onclick="deleteTimeSlot('${timeSlotCounter}')">Delete Time Slot</button>
      `;

      // Make the time editable
      const timeSpan = newTimeSlot.querySelector('.time');
      timeSpan.contentEditable = true;
      timeSpan.addEventListener('blur', () => {
        saveActivities(); // Save the updated time when focus is lost
      });

      const container = document.querySelector(".container");
      container.insertBefore(newTimeSlot, container.lastElementChild);
      saveActivities();
    }

    function changeSlotColor(time) {
      const timeSlot = document.getElementById(`timeSlot-${time}`);
      const colorInput = document.getElementById(`color-${time}`);
      timeSlot.style.backgroundColor = colorInput.value;
      saveActivities();
    }

    function deleteTimeSlot(time) {
      const timeSlot = document.getElementById(`timeSlot-${time}`);
      timeSlot.remove();
      saveActivities();
    }

    function saveActivities() {
      const activitiesData = {};
      const timeSlots = document.querySelectorAll(".time-slot");

      timeSlots.forEach(timeSlot => {
        const time = timeSlot.id.replace("timeSlot-", "");
        activitiesData[time] = {
          color: document.getElementById(`color-${time}`).value,
          activities: Array.from(timeSlot.querySelector("ul").children).map(li => li.textContent.trim())
        };
      });

      localStorage.setItem("routineActivities", JSON.stringify(activitiesData));
    }

    function loadActivities() {
      const savedActivities = JSON.parse(localStorage.getItem("routineActivities"));
      if (savedActivities) {
        for (const time in savedActivities) {
          const timeSlot = document.getElementById(`timeSlot-${time}`);
          if (timeSlot) {
            timeSlot.style.backgroundColor = savedActivities[time].color;
            savedActivities[time].activities.forEach(activity => {
              addActivity(time, activity);
            });
          }
        }
      }
    }

    // Load activities on page load
    loadActivities();
  </script>
</body>
</html>
